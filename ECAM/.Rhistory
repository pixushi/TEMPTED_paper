position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=16, y=0.55) +
coord_cartesian(clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
p_subj_pr
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=16, y=0.55) +
coord_cartesian(xlim=c(2,10), clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
scale_color_manual(values=color_method) +
()
p_subj_pr
p_subj_pr
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=16, y=0.5) +
coord_cartesian(xlim=c(1,10), clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
p_subj_pr
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=15, y=0.5) +
coord_cartesian(xlim=c(1,9), clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=14, y=0.5) +
coord_cartesian(xlim=c(1,9), clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=13, y=0.5) +
coord_cartesian(xlim=c(1,9), clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=13.5, y=0.5) +
coord_cartesian(xlim=c(1,9), clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
tab_auc_subj$nsample <- as.factor(tab_auc_subj$nsample)
tab1 <- aggregate(auc~nsample+measure+method+classify+type, data=tab_auc_subj,
FUN=mean)
names(tab1)[6] <- 'mean'
tab2 <- aggregate(auc~nsample+measure+method+classify+type, data=tab_auc_subj,
FUN=function(x){sd(x)/sqrt(length(x))})
names(tab2)[6] <- 'se'
rownames(tab1) <-rownames(tab2) <- NULL
tab_auc_subj_summary <- merge(tab1, tab2)
tab_auc_subj_summary$nsample <- factor(tab_auc_subj_summary$nsample,
level=as.character(nkeep))
color_method <- c('#33a02c', #green for CTF
'#377eb8') #blue for TEMPTED
p_subj_roc <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="ROC"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=13.5, y=0.5) +
coord_cartesian(clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-ROC error', x='# time points') +
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_roc
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=13.5, y=0.5) +
coord_cartesian(xlim=c(1,9), clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
metric_name <- c("Bray-Curtis",
"unweighted_UniFrac", "Weighted_UniFrac")
# read in results
Fmodel <- array(0, dim=c(length(metric_name)+2, nsim, length(nkeep)),
dimnames=list(c(metric_name, "TEMPTED", "CTF"), paste0('sim',1:nsim), paste0('nsample=',nkeep)))
for (ii in 1:length(metric_name)){
Fmodel[ii,,] <- as.matrix(read.csv(paste0('result/realsim_ecam_Fvalue_PCoA_', metric_name[ii], '.csv'),
row.names=1))
}
Fmodel_tempted <- read.csv("result/realsim_ecam_Fvalue_tempted_clr.csv", row.names=1)
Fmodel[ii+1,,] <- as.matrix(Fmodel_tempted)
Fmodel_ctf <- read.csv("result/realsim_ecam_Fvalue_ctf.csv", row.names=1)
Fmodel[ii+2,,] <- as.matrix(Fmodel_ctf)
# make table
tab_Fmodel <- NULL
for (ii in 1:dim(Fmodel)[1]){
tab_tmp <- data.frame(Fvalue=as.vector(Fmodel[ii,,]),
nsample=as.vector(t(matrix(rep(nkeep,nsim),length(nkeep),nsim))),
method=dimnames(Fmodel)[[1]][ii])
tab_Fmodel <- rbind(tab_Fmodel, tab_tmp)
}
tab_Fmodel$method[tab_Fmodel$method=="unweighted_UniFrac"] <- "UniFrac"
tab_Fmodel$method[tab_Fmodel$method=="Weighted_UniFrac"] <- "Weighted UniFrac"
tab1 <- aggregate(Fvalue~nsample+method, data=tab_Fmodel,
FUN=mean)
names(tab1)[3] <- 'mean'
tab2 <- aggregate(Fvalue~nsample+method, data=tab_Fmodel,
FUN=function(x){sd(x)/sqrt(length(x))})
names(tab2)[3] <- 'se'
rownames(tab1) <-rownames(tab2) <- NULL
tab_Fmodel_summary <- merge(tab1, tab2)
color_method <- c('#ff7f00', #orange for Bray
'#33a02c', #green for CTF
'#377eb8', #blue for TEMPTED
'#6a3d9a', #purple for Unifrac
'#e31a1c') #red for unweighted Unifrac
p_Fmodel_summary <- ggplot(data=tab_Fmodel_summary,
aes(x=nsample, y=mean, group=method, color=method)) +
geom_line(size=1, position=position_dodge(0.1)) + geom_point(size=2, position=position_dodge(0.1)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=1),
position=position_dodge(0.1), size=1) +
scale_x_continuous(breaks=2:10) +
scale_color_manual(values=color_method) +
ylab('PERMANOVA F value') + xlab('# time points') +
ggtitle("Sample Level") +
theme_bw() +
theme(legend.position = "bottom")
p_Fmodel_summary
method  <- c("tempted_clr", "ctf", "PCoA_Bray-Curtis", "PCoA_unweighted_UniFrac", "PCoA_Weighted_UniFrac")
measure <- c("roc", "pr")
classify <- c("glm", "rf")
tab_auc_sample <- NULL
for (ms in measure){
for (cls in classify){
for (mthd in method){
fname <- paste0("result/realsim_ecam_", ms, "_sample_", cls, "_", mthd, ".csv")
tab0 <- read.csv(fname, row.names=1)
tab0 <- 1-as.matrix(tab0)
tab_tmp <- data.frame(auc=as.vector(tab0),
nsample=as.vector(t(matrix(rep(nkeep,nsim),length(nkeep),nsim))),
method=mthd, measure=toupper(ms), classify=cls,
type="In-Sample")
tab_auc_sample <- rbind(tab_auc_sample, tab_tmp)
}
}
}
tab_auc_sample$classify <- gsub("glm", "Logistic Regression", tab_auc_sample$classify)
tab_auc_sample$classify <- gsub("rf", "Random Forest", tab_auc_sample$classify)
tab_auc_sample$method <- gsub("tempted_clr", "TEMPTED", tab_auc_sample$method)
tab_auc_sample$method <- gsub("ctf", "CTF", tab_auc_sample$method)
tab_auc_sample$method <- gsub("PCoA_Bray-Curtis", "Bray-Curtis", tab_auc_sample$method)
tab_auc_sample$method <- gsub("PCoA_unweighted_UniFrac", "UniFrac", tab_auc_sample$method)
tab_auc_sample$method <- gsub("PCoA_Weighted_UniFrac", "Weighted UniFrac", tab_auc_sample$method)
tab1 <- aggregate(auc~nsample+method+type+measure+classify, data=tab_auc_sample,
FUN=mean)
names(tab1)[6] <- 'mean'
tab2 <- aggregate(auc~nsample+method+type+measure+classify, data=tab_auc_sample,
FUN=function(x){sd(x)/sqrt(length(x))})
names(tab2)[6] <- 'se'
rownames(tab1) <-rownames(tab2) <- NULL
tab_auc_sample_summary <- merge(tab1, tab2)
tab_auc_sample_summary$nsample <- factor(tab_auc_sample_summary$nsample,
level=as.character(nkeep))
color_method <- c('#ff7f00', #orange for Bray
'#33a02c', #green for CTF
'#377eb8', #blue for TEMPTED
'#6a3d9a', #purple for Unifrac
'#e31a1c') #red for Weighted Unifrac
p_sample_roc <- ggplot(data=dplyr::filter(tab_auc_sample_summary, measure=="ROC"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(position=position_dodge(0.1), size=1, aes(linetype=type)) +
geom_point(position=position_dodge(0.1), size=2) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.1), size=1) +
facet_wrap(.~classify) +
labs(y='AUC-ROC error', x='# time points') +
ggtitle("Sample Level") +
scale_color_manual(values=color_method) +
theme_bw() +
theme(legend.position="bottom")
p_sample_roc
p_sample_pr <- ggplot(data=dplyr::filter(tab_auc_sample_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(position=position_dodge(0.1), size=1, aes(linetype=type)) +
geom_point(position=position_dodge(0.1), size=2) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.1), size=1) +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points') +
ggtitle("Sample Level") +
scale_color_manual(values=color_method) +
theme_bw() +
theme(legend.position="bottom")
p_sample_pr
color_method <- c('#ff7f00', #orange for Bray
'#33a02c', #green for CTF
'#377eb8', #blue for TEMPTED
'#6a3d9a', #purple for Unifrac
'#e31a1c') #red for unweighted Unifrac
tab_lgd <- data.frame(Method=rep(c("Bray-Curtis", "CTF",
"TEMPTED", "UniFrac","Weighted UniFrac"),4),
value=rnorm(20), time=rnorm(20),
Type=c(rep("In-Sample",each=10), rep("Out-of-Sample", each=10)))
p_lgd <- ggplot(data=tab_lgd, aes(x=time, y=value, color=Method)) +
geom_point(size=2) + geom_line(aes(linetype=Type), size=1) +
scale_color_manual(values=color_method) +
theme(legend.position="bottom")
p_lgd
lgd <- get_legend(p_lgd)
lay <- rbind(c(1,1,2),c(1,1,2),c(1,1,2),c(1,1,2),c(1,1,2),
c(3,3,3))
p_all <- grid.arrange(p_subj_pr + theme(legend.position="none"),
p_Fmodel_summary + theme(legend.position="none"),
lgd,
layout_matrix=lay)
ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=-1.5, y=0.5, size=0.5) +
coord_cartesian(xlim=c(1,9), clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=-1.5, y=0.5, size=5) +
coord_cartesian(xlim=c(1,9), clip="off") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
p_subj_pr
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=-1.5, y=0.5, size=5) +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
annotate("text", label="At Random", x=-1.5, y=0.5, size=5) +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
ann_text <- data.frame(nsampe=9, mean=0.52, lab = "At random",
classify = "Random Forest")
ann_text <- data.frame(nsampe=9, mean=0.52, lab = "At random",
classify = "Random Forest")
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
geom_text(data = ann_text,label = "At random") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
colnames(tab_auc_subj_summary)
head(tab_auc_subj_summary)
ann_text <- data.frame(nsampe=9, measure="CTF", classify = "Random Forest", type="In-Sample", mean=0.52, se=0)
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
geom_text(data = ann_text,label = "At random") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
ann_text <- data.frame(nsample=9, measure="CTF", classify = "Random Forest", type="In-Sample", mean=0.52, se=0)
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
geom_text(data = ann_text,label = "At random") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
ann_text
ann_text <- tab_auc_subj_summary[1,]
ann_text$mean <- 0.52
ann_text$nsample <- 8
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
geom_text(data = ann_text,label = "At random") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
tab_auc_subj_summary[2,]
ann_text <- tab_auc_subj_summary[2,]
ann_text$mean <- 0.52
ann_text$nsample <- 8
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
geom_text(data = ann_text,label = "At random", color="black") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
p_subj_pr
ann_text <- tab_auc_subj_summary[2,]
ann_text$mean <- 0.51
ann_text$nsample <- 7
p_subj_pr <- ggplot(data=dplyr::filter(tab_auc_subj_summary, measure=="PR"),
aes(x=nsample, y=mean, group=paste0(type,method), color=method)) +
geom_line(size=1, position=position_dodge(0.5), aes(linetype=type)) +
geom_point(size=2, position=position_dodge(0.5)) +
geom_errorbar(aes(ymin=mean-2*se, ymax=mean+2*se, width=0.5),
position=position_dodge(0.5), size=1) +
geom_hline(yintercept=0.5, linetype="dotted", color = "black", size=1) +
geom_text(data = ann_text,label = "At random", color="black") +
facet_wrap(.~classify) +
labs(y='AUC-PR error', x='# time points')+
ggtitle("Subject Level") +
scale_color_manual(values=color_method) +
theme_bw()
p_subj_pr
p_subj_pr
pnorm(-1.184)
pnorm(1.184)
pnorm(-1.184)*2
pnorm(1.96)
pnorm(-1.96)
pnorm(-1.96)*2
qnorm(-1.184)*2
pnorm(-1.184)*2
pt(-1.184, 50,)*2
pt(-1.184, 50)*2
pt(-1.184, 58)*2
install.packages(lmerTest)
install.packages("lmerTest")
library(lmerTest)
data("sleepstudy", package="lme4")
fm <- lmer(Reaction ~ Days + I(Days^2) + (1|Subject) + (0+Days|Subject),
sleepstudy)
# F-test of third coeffcients - I(Days^2):
contest(fm, c(0, 0, 1))
# Equivalent t-test:
contest(fm, L=c(0, 0, 1), joint=FALSE)
# Test of 'Days + I(Days^2)':
contest(fm, L=diag(3)[2:3, ])
# Other options:
contest(fm, L=diag(3)[2:3, ], joint=FALSE)
contest(fm, L=diag(3)[2:3, ], joint=FALSE, collect=FALSE)
# Illustrate a list argument:
L <- list("First"=diag(3)[3, ], "Second"=diag(3)[-1, ])
contest(fm, L)
contest(fm, L, collect = FALSE)
contest(fm, L, joint=FALSE, confint = FALSE)
contest(fm, L, joint=FALSE, collect = FALSE, level=0.99)
# Illustrate testing of estimability:
# Consider the 'cake' dataset with a missing cell:
data("cake", package="lme4")
cake$temperature <- factor(cake$temperature, ordered=FALSE)
cake <- droplevels(subset(cake, temperature %in% levels(cake$temperature)[1:2] &
!(recipe == "C" & temperature == "185")))
with(cake, table(recipe, temperature))
fm <- lmer(angle ~ recipe * temperature + (1|recipe:replicate), cake)
fixef(fm)
# The coefficient for recipeC:temperature185 is dropped:
attr(model.matrix(fm), "col.dropped")
# so any contrast involving this coefficient is not estimable:
Lmat <- diag(6)
contest(fm, Lmat, joint=FALSE, check_estimability = TRUE)
L
L2 <- L$Second
contest(fm, L2)
contest(fm, L=L2)
contest(fm, L=diag(3)[2:3, ], joint=FALSE)
data("sleepstudy", package="lme4")
fm <- lmer(Reaction ~ Days + I(Days^2) + (1|Subject) + (0+Days|Subject),
sleepstudy)
# F-test of third coeffcients - I(Days^2):
contest(fm, c(0, 0, 1))
# Equivalent t-test:
contest(fm, L=c(0, 0, 1), joint=FALSE)
# Test of 'Days + I(Days^2)':
contest(fm, L=diag(3)[2:3, ])
# Other options:
contest(fm, L=diag(3)[2:3, ], joint=FALSE)
diag(3)[2:3, ]
summary(fm)
L2
L2[1,] <- c(0,1,-1)
contest(fm, L=L2, joint=FALSE)
